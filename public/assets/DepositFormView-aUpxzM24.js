import{_ as F,c as b,i as S,r as k,o as V,a as r,b as a,t as d,u as m,h as j,w as p,j as f,v as y,n as g,k as N,F as U,e as x,f as C,g as n}from"./index-Cp2leT6j.js";import{u as M}from"./deposit-CE66YNY9.js";import{u as B}from"./category-_7hyEaxh.js";const K={class:"deposit-form"},E={key:0,class:"loading"},I={key:1,class:"error"},W={class:"form-group"},A={key:0,class:"error-message"},R={class:"form-group"},$={key:0,class:"error-message"},L={class:"form-group"},O=["value"],T={class:"form-group"},q={key:0,class:"error-message"},G={class:"form-actions"},H={type:"submit",class:"submit-button"},J={__name:"DepositFormView",setup(P){const w=S(),v=C(),l=M(),_=B(),u=b(()=>w.name==="deposit-edit"),c=b(()=>w.params.id),t=k({name:"",amount:"",category_id:null,date:new Date().toISOString().substr(0,10)}),s=k({}),z=()=>{s.value={};let o=!0;return t.value.name||(s.value.name="Nazwa jest wymagana",o=!1),t.value.amount?(isNaN(t.value.amount)||parseFloat(t.value.amount)<0)&&(s.value.amount="Kwota musi być liczbą dodatnią",o=!1):(s.value.amount="Kwota jest wymagana",o=!1),t.value.date||(s.value.date="Data jest wymagana",o=!1),o},D=async()=>{if(z())try{const o={...t.value,amount:parseFloat(t.value.amount)};u.value?(await l.updateDeposit(c.value,o),alert("Wpłata zaktualizowana pomyślnie")):(await l.createDeposit(o),alert("Wpłata utworzona pomyślnie")),v.push({name:"deposits"})}catch(o){alert(`Błąd ${u.value?"aktualizacji":"tworzenia"} wpłaty: ${o.message||"Nieznany błąd"}`)}},h=()=>{u.value?v.push({name:"deposit-details",params:{id:c.value}}):v.push({name:"deposits"})};return V(async()=>{try{await _.fetchCategories()}catch(o){console.error("Failed to fetch categories:",o)}if(u.value)try{await l.fetchDeposit(c.value),l.deposit&&(t.value={name:l.deposit.name,amount:l.deposit.amount,category_id:l.deposit.category_id||null,date:l.deposit.date})}catch(o){console.error("Failed to fetch deposit details:",o)}}),(o,e)=>(n(),r("div",K,[a("h1",null,d(u.value?"Edytuj wpłatę":"Utwórz nową wpłatę"),1),u.value&&m(l).loading?(n(),r("div",E," Ładowanie danych wpłaty... ")):u.value&&m(l).error?(n(),r("div",I,d(m(l).error),1)):(n(),r("form",{key:2,onSubmit:j(D,["prevent"]),class:"form"},[a("div",W,[e[4]||(e[4]=a("label",{for:"name"},"Nazwa",-1)),p(a("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=i=>t.value.name=i),type:"text",class:g(["form-control",{"is-invalid":s.value.name}])},null,2),[[y,t.value.name]]),s.value.name?(n(),r("div",A,d(s.value.name),1)):f("",!0)]),a("div",R,[e[5]||(e[5]=a("label",{for:"amount"},"Kwota",-1)),p(a("input",{id:"amount","onUpdate:modelValue":e[1]||(e[1]=i=>t.value.amount=i),type:"number",step:"0.01",min:"0",class:g(["form-control",{"is-invalid":s.value.amount}])},null,2),[[y,t.value.amount]]),s.value.amount?(n(),r("div",$,d(s.value.amount),1)):f("",!0)]),a("div",L,[e[7]||(e[7]=a("label",{for:"category_id"},"Kategoria",-1)),p(a("select",{id:"category_id","onUpdate:modelValue":e[2]||(e[2]=i=>t.value.category_id=i),class:"form-control"},[e[6]||(e[6]=a("option",{value:""},"Wybierz kategorię",-1)),(n(!0),r(U,null,x(m(_).categories,i=>(n(),r("option",{key:i.id,value:i.id},d(i.name),9,O))),128))],512),[[N,t.value.category_id]])]),a("div",T,[e[8]||(e[8]=a("label",{for:"date"},"Data",-1)),p(a("input",{id:"date","onUpdate:modelValue":e[3]||(e[3]=i=>t.value.date=i),type:"date",class:g(["form-control",{"is-invalid":s.value.date}])},null,2),[[y,t.value.date]]),s.value.date?(n(),r("div",q,d(s.value.date),1)):f("",!0)]),a("div",G,[a("button",{type:"button",onClick:h,class:"cancel-button"},"Anuluj"),a("button",H,d(u.value?"Aktualizuj":"Utwórz"),1)])],32))]))}},Z=F(J,[["__scopeId","data-v-38e92bc5"]]);export{Z as default};
